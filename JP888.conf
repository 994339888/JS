/*        
        âªï¼šJP APP âœ¦ Mercari é¦–é¡µæé€Ÿæ¸…çˆ½è„šæœ¬ âœ¦
        âœ¦ äºŒåˆä¸€ç‰ˆï¼ˆé…ç½® + æˆæƒç³»ç»Ÿ + JS è„šæœ¬ï¼‰âœ¦

ğŸ“Œ åŠŸèƒ½ï¼š
    - æé€Ÿæ¸…ç†é¦–é¡µï¼ˆç§’å¼€ï¼‰
    - æ”¯æŒå¯†é’¥æˆæƒï¼Œå…¨ä½“ç»Ÿä¸€å¼€å…³
    - åˆ«äººå¤åˆ¶ä¹Ÿæ— æ³•ç»•è¿‡
    - é…ç½®+è„šæœ¬åˆä½“ï¼ŒQX å¯ç›´æ¥è§£æ

ğŸ“Œ ä½¿ç”¨æ–¹å¼ï¼ˆQuantumultXï¼‰ï¼š
ç›´æ¥å†™ä¸€æ¡è§„åˆ™å³å¯ï¼š

^https?:\/\/api\.mercari\.jp\/services\/home\/v2\/homefeed-contents url script-response-body https://raw.githubusercontent.com/994339888/JS/main/JP888.conf

ï¼ˆä¸ç”¨å†å†™ [rewrite_local]ï¼Œå› ä¸ºè¿™ä¸ªæ–‡ä»¶æœ¬èº«å·²ç»åŒ…å«å®Œæ•´é…ç½®ï¼‰

ğŸ“Œ å¯†é’¥æ–‡ä»¶ï¼ˆä½ æ§åˆ¶æ‰€æœ‰ç”¨æˆ·ï¼‰ï¼š
https://cdn.jsdelivr.net/gh/994339888/JS/key.txt
å†…å®¹ç¤ºä¾‹ï¼š
abc123
*/

/*===================== 1ï¸âƒ£ Quantumult X é…ç½®åŒº =====================*/

[rewrite_local]
^https?:\/\/api\.mercari\.jp\/services\/home\/v2\/homefeed-contents url script-response-body JP888.js

[MITM]
hostname = api.mercari.jp


/*===================== 2ï¸âƒ£ ä¸‹é¢å¼€å§‹ JS è„šæœ¬ =====================*/

// âš ï¸ ä»¥ä¸‹æ˜¯è„šæœ¬ä¸»ä½“ï¼ŒQuantumult X ä¼šè‡ªåŠ¨æ‰§è¡Œ
// âš ï¸ è¿™æ˜¯â€œäºŒåˆä¸€æ–‡ä»¶â€æ”¯æŒçš„å®˜æ–¹æ ¼å¼ï¼šè„šæœ¬ç´§è·Ÿåœ¨é…ç½®å
// âš ï¸ ä¸è¦åˆ é™¤ "JP888.js" è¡Œï¼Œå®ƒæ˜¯ QX çš„â€œä¼ªæ–‡ä»¶åâ€ï¼ˆå¿…é¡»ä¿ç•™ï¼‰


#!name=JP888.js
#!desc=Mercari æé€Ÿé¦–é¡µ + å¯†é’¥æˆæƒç³»ç»Ÿ


/*******************************
 * è¯»å–è¿œç¨‹æˆæƒå¯†é’¥ï¼ˆä½¿ç”¨ jsDelivrï¼‰
 *******************************/
const authUrl = "https://cdn.jsdelivr.net/gh/994339888/JS/key.txt";

$httpClient.get(authUrl, function(error, resp, data) {

    if (error || resp.status !== 200) {
        $done({ body: "{}" });
        return;
    }

    const serverKey = data.trim();
    const localKey = "abc123"; // æœ¬åœ°å¯†é’¥ï¼ˆä½ è®¾å®šçš„æ­£ç¡®ç­”æ¡ˆï¼‰

    if (serverKey !== localKey) {
        $done({ body: "{}" });
        return;
    }

    // å¯†é’¥åŒ¹é…æˆåŠŸ â†’ é¦–é¡µæé€Ÿæ¸…ç©ºç”Ÿæ•ˆ
    const minimalResponse = {
        data: [],
        meta: { status: "ok" }
    };

    $done({
        body: JSON.stringify(minimalResponse)
    });
});